ğŸ” REPLIT AGENT â€” PATCH 3 (EXECUTE IMMEDIATELY)

ğŸ“Œ PATCH METADATA

PROJECT: Final Dashboard 4.0
PATCH NAME: Online Ordering â€“ Menu & Modifier Alignment
SCOPE: Frontend (Online Ordering only)
RISK LEVEL: LOWâ€“MEDIUM
CHANGE TYPE: Wiring / Flow Alignment
SOURCE OF TRUTH: Loyverse menu + Patch 2 modifier rules


---

ğŸš« HARD STOPS (NON-NEGOTIABLE)

Agent MUST NOT:

Modify backend APIs

Modify POS logic

Modify Recipes

Modify pricing logic

Add new menu items not in Loyverse

Touch Daily Sales / Stock systems

Refactor unrelated UI


If blocked â†’ STOP AND REPORT


---

ğŸ¯ OBJECTIVE

Make Online Ordering load the same menu + modifier logic as POS, so:

One menu truth

Same modifier rules

Clean tickets

Zero staff confusion



---

ğŸ“ FILES ALLOWED TO TOUCH (STRICT)

âœ… client/src/pages/online-ordering/Menu.tsx
âœ… client/src/pages/online-ordering/ItemModal.tsx
âœ… client/src/pages/online-ordering/modifiers.ts
âœ… client/src/data/menu.ts (if exists)

âŒ Everything else â†’ DO NOT TOUCH


---

ğŸ§© STEP 1 â€” MENU SOURCE LOCK (CRITICAL)

Replace any hardcoded online menu with canonical menu data.

Required behaviour

Online ordering menu must load from the same menu dataset used for POS

Categories must match Loyverse categories exactly

No duplicate menu definitions


Implementation

In Menu.tsx:

import { getCanonicalMenu } from "@/data/menu";

const menu = getCanonicalMenu(); // single source of truth

âŒ Remove any inline arrays, mock data, or duplicated menu objects.


---

ğŸ§© STEP 2 â€” MODIFIER GROUP TYPES (FROM PATCH 2)

In modifiers.ts, enforce explicit modifier group typing:

export type ModifierGroupType = "REQUIRED" | "OPTIONAL" | "BUNDLE";

export interface ModifierGroup {
  id: string;
  name: string;
  type: ModifierGroupType;
  modifiers: Modifier[];
}


---

ğŸ§© STEP 3 â€” REQUIRED MODIFIER ENFORCEMENT

In ItemModal.tsx, block add-to-cart unless REQUIRED groups are satisfied:

const missingRequired = modifierGroups
  .filter(g => g.type === "REQUIRED")
  .some(g => !selectedModifiers[g.id]);

if (missingRequired) {
  setError("Please select required options");
  return;
}

No exceptions.


---

ğŸ§© STEP 4 â€” MODIFIER DISPLAY ORDER (LOCKED)

Render modifier groups in this order only:

const orderedGroups = [
  ...groups.filter(g => g.type === "REQUIRED"),
  ...groups.filter(g => g.type === "OPTIONAL"),
  ...groups.filter(g => g.type === "BUNDLE"),
];

âŒ No per-item overrides
âŒ No UI reordering


---

ğŸ§© STEP 5 â€” MEAL DEAL HANDLING

Meal deals must:

Be parent items

Force side + drink selection

Prevent duplicate modifiers


Implementation rule:

if (item.type === "MEAL_DEAL") {
  disableChildModifiers();
}

This prevents double-ups and POS confusion.


---

ğŸ§© STEP 6 â€” TICKET OUTPUT SANITY

Ensure cart summary renders as:

Item Name
  + Modifier 1
  + Modifier 2

No hidden defaults.
No collapsed modifiers.


---

ğŸ§ª VERIFICATION (MANDATORY)

Agent must verify:

Burger order â†’ modifiers enforced

Meal deal â†’ forced drink + side

Drink â†’ no food modifiers

Cart output mirrors POS ticket style

No console errors



---

ğŸ§¾ AGENT FINAL RESPONSE (STRICT)

Agent must reply with only one:

PATCH 3 COMPLETE â€” Online ordering aligned

BLOCKED â€” <exact blocker>


No explanations.


---

ğŸ”’ END OF PATCH 3