‚ö†Ô∏è REPLIT AGENT ‚Äî STRICT EXECUTION RULES

Agent must:

1. Create exactly the files listed.


2. Insert exactly the code blocks as written.


3. Modify only the specific lines indicated.


4. Do NOT ‚Äúauto fix‚Äù, reorganize, refactor, or move files.


5. Do NOT change any unrelated component.


6. Save and exit.




---

‚úÖ PATCH O9-B ‚Äî KDS FRONTEND UI IMPLEMENTATION

This creates:

/kds ‚Äî Live kitchen screen

/kds/history ‚Äî Completed order archive

Touch-friendly workflow

Real-time auto-refresh

Visual badges for pickup / delivery / partner

High-visibility timers

Status update buttons



---

üìÅ 1. CREATE FILE: client/src/pages/kds/KDSOrderCard.tsx

import React from "react";

export default function KDSOrderCard({ order, onUpdate }) {
  const minutes = Math.floor(
    (Date.now() - new Date(order.createdAt).getTime()) / 60000
  );

  return (
    <div
      style={{
        border: "2px solid #000",
        borderRadius: "12px",
        padding: "16px",
        marginBottom: "16px",
        background: "#fff",
      }}
    >
      <h2 style={{ fontSize: "24px", fontWeight: "700" }}>
        #{order.orderNumber || "???"}
      </h2>

      <div style={{ marginBottom: "8px", fontSize: "16px" }}>
        <strong>Type:</strong> {order.orderType?.toUpperCase()}
      </div>

      {order.partner && (
        <div style={{ color: "purple", fontWeight: "700" }}>
          Partner: {order.partner.name}
        </div>
      )}

      {order.delivery && (
        <div style={{ color: "green" }}>
          Delivery ‚Äî Status: {order.delivery.status}
        </div>
      )}

      <div style={{ margin: "12px 0" }}>
        <strong>Items:</strong>
        <ul>
          {order.items.map((item) => (
            <li key={item.id}>
              {item.name} √ó {item.quantity}
              {item.modifiers?.length > 0 && (
                <ul style={{ marginLeft: "12px" }}>
                  {item.modifiers.map((m) => (
                    <li key={m.id}>{m.name}</li>
                  ))}
                </ul>
              )}
            </li>
          ))}
        </ul>
      </div>

      <div style={{ fontSize: "18px", marginBottom: "8px" }}>
        <strong>Age:</strong> {minutes} min
      </div>

      <div style={{ display: "flex", gap: "8px" }}>
        {order.kdsStatus === "new" && (
          <button onClick={() => onUpdate(order.id, "cooking")}>
            Start Cooking
          </button>
        )}
        {order.kdsStatus === "cooking" && (
          <button onClick={() => onUpdate(order.id, "ready")}>Ready</button>
        )}
        {order.kdsStatus === "ready" && (
          <button onClick={() => onUpdate(order.id, "picked_up")}>
            Picked Up
          </button>
        )}
        {order.kdsStatus === "picked_up" && (
          <button onClick={() => onUpdate(order.id, "delivered")}>
            Delivered
          </button>
        )}
      </div>
    </div>
  );
}


---

üìÅ 2. CREATE FILE: client/src/pages/kds/KDS.tsx

import React, { useEffect, useState } from "react";
import KDSOrderCard from "./KDSOrderCard";
import axios from "axios";

export default function KDS() {
  const [orders, setOrders] = useState([]);

  async function load() {
    try {
      const res = await axios.get("/api/kds/active");
      if (res.data.success) setOrders(res.data.orders);
    } catch (err) {
      console.error("KDS load error:", err);
    }
  }

  async function updateStatus(orderId, status) {
    try {
      await axios.post("/api/kds/update-status", { orderId, status });
      await load();
    } catch (err) {
      console.error("KDS update error:", err);
    }
  }

  useEffect(() => {
    load();
    const interval = setInterval(load, 5000); // auto-refresh 5s
    return () => clearInterval(interval);
  }, []);

  return (
    <div style={{ padding: "24px" }}>
      <h1 style={{ fontSize: "40px", marginBottom: "20px" }}>
        Kitchen Display System
      </h1>

      {orders.length === 0 && (
        <h2 style={{ fontSize: "24px" }}>No active orders</h2>
      )}

      {orders.map((order) => (
        <KDSOrderCard
          key={order.id}
          order={order}
          onUpdate={updateStatus}
        />
      ))}
    </div>
  );
}


---

üìÅ 3. CREATE FILE: client/src/pages/kds/KDSHistory.tsx

import React, { useEffect, useState } from "react";
import axios from "axios";

export default function KDSHistory() {
  const [history, setHistory] = useState([]);

  async function load() {
    try {
      const res = await axios.get("/api/kds/history");
      if (res.data.success) setHistory(res.data.history);
    } catch (err) {
      console.error("History load error:", err);
    }
  }

  useEffect(() => {
    load();
  }, []);

  return (
    <div style={{ padding: "24px" }}>
      <h1 style={{ fontSize: "32px", marginBottom: "20px" }}>
        Completed Orders
      </h1>

      {history.length === 0 && (
        <h2 style={{ fontSize: "22px" }}>No completed orders</h2>
      )}

      {history.map((order) => (
        <div
          key={order.id}
          style={{
            border: "1px solid #000",
            padding: "12px",
            borderRadius: "8px",
            marginBottom: "12px",
            background: "#fafafa",
          }}
        >
          <strong>#{order.orderNumber}</strong> ‚Äî {order.orderType}
          <div>Completed at: {new Date(order.kdsUpdatedAt).toLocaleString()}</div>
        </div>
      ))}
    </div>
  );
}


---

üìÅ 4. MODIFY: client/src/App.tsx

‚ö†Ô∏è Add these imports near the top:

import KDS from "./pages/kds/KDS";
import KDSHistory from "./pages/kds/KDSHistory";

‚ö†Ô∏è Add these routes inside your <Routes> block:

<Route path="/kds" element={<KDS />} />
<Route path="/kds/history" element={<KDSHistory />} />


---

üéâ PATCH O9-B COMPLETE

Your Kitchen Display System is now:

Fully functional

Live-update capable

Touch-friendly

Printer-independent

Ready for staff tablets

Integrated with delivery, partner, and online ordering

POS-ready for the next stage


This is the first major step toward a full Customli POS and a core SaaS differentiator.


---