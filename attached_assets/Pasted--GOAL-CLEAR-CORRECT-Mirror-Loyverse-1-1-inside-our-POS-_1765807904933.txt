
üéØ GOAL (CLEAR & CORRECT)

> Mirror Loyverse 1:1 inside our POS first
Then evolve recipes, costing, intelligence after continuity is guaranteed.



This achieves:

Zero operational disruption

Immediate staff familiarity

Trust from current team

Clean foundation for recipes, stock, AI, SaaS



---

üß† WHY THIS IS THE RIGHT MOVE (NO THEORY)

Loyverse already contains:

Proven menu structure

Correct modifiers

Correct pricing

Correct naming

Correct tax logic

Real-world usage data


Trying to ‚Äúrebuild menu logic first‚Äù is how POS systems fail.

We import reality first. Then we improve it.


---

üü¶ PATCH L2.1 ‚Äî LOYVERSE MENU CANONICAL IMPORT

(POS Ground Truth Alignment)

This patch is READ + CREATE ONLY, no deletes, no overwrites.


---

üîí NON-NEGOTIABLE RULES

‚ùå Do NOT delete any Menu V3 records

‚ùå Do NOT overwrite manually created items

‚ùå Do NOT touch recipes yet

‚ùå Do NOT auto-link ingredients

‚ùå Do NOT change pricing logic


‚úÖ Import-only
‚úÖ Idempotent
‚úÖ Re-runnable
‚úÖ Audited


---

üß© WHAT WE IMPORT FROM LOYVERSE (EXACT SCOPE)

1Ô∏è‚É£ Items (Sale Items)

From Loyverse:

Item name

Price

SKU / ID

Category

Tax settings

Visibility


Into:

menu_items_v3


With metadata:

source: 'loyverse'
externalSystem: 'loyverse'
externalId: loyverseItemId
importedAt


---

2Ô∏è‚É£ Categories

From Loyverse:

Category name

Ordering / position


Into:

menu_categories_v3


‚ö†Ô∏è Do not merge with existing categories automatically
‚ö†Ô∏è Match by name only if exact


---

3Ô∏è‚É£ Modifiers & Modifier Groups

From Loyverse:

Modifier group name

Required / optional

Min / max selections

Modifier prices


Into:

menu_modifiers_group_v3

menu_modifiers_v3

Item ‚Üî modifier group relationships



---

4Ô∏è‚É£ Mapping Table (CRITICAL)

Create / populate:

loyverse_map_v2

Purpose:

Map Loyverse IDs ‚Üí internal Menu V3 IDs

Enable:

POS sync

Order pushback

Stock deduction later




---

üõ†Ô∏è IMPLEMENTATION DETAILS (AGENT MUST FOLLOW)

Step 1 ‚Äî Fetch Loyverse Data

Use existing Loyverse API credentials.

Endpoints (example):

/items

/categories

/modifiers


‚ö†Ô∏è Pull all active items only


---

Step 2 ‚Äî Dry Run First

Endpoint:

POST /api/admin/import/loyverse/menu?dryRun=true

Response must show:

Items found

Items to be created

Items skipped (already exist)

Modifier groups found

Modifiers found


No writes.


---

Step 3 ‚Äî Import Execution

POST /api/admin/import/loyverse/menu

Rules:

If item exists with same externalId ‚Üí skip

If exists by name but no externalId ‚Üí skip + report

Never overwrite price



---

Step 4 ‚Äî Reporting

Store report in:

migration_reports_v1

Include:

Counts

Skipped items

Conflicts

Errors



---