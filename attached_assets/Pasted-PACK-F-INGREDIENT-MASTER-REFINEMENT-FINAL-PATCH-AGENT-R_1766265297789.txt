PACK F â€” INGREDIENT MASTER REFINEMENT (FINAL PATCH)
âš ï¸ AGENT RULES (NON-NEGOTIABLE)
DO NOT attach ingredients to recipes
DO NOT add pricing logic to recipes
DO NOT change purchasing prices or purchasing schemas
DO NOT auto-link ingredients to purchasing items
ONLY allow manual selection by user
NO hardcoded units or assumptions
ğŸ¯ PACK F OBJECTIVE
Create a clean, editable Ingredient Master List that:
Represents what goes into food
Is independent of purchasing
Can optionally reference purchasing items for cost preview
Is ready for later recipe portion assignment
ğŸ§± INGREDIENT MASTER MODEL (NO SCHEMA BREAKS)
Table: ingredients
Required fields (already exist or must be added additively only):
id
name
category
baseUnit
enum/text: g, ml, unit, slice, etc.
defaultPortion (nullable)
e.g. 90, 12, 1
linkedPurchasingItemId (nullable FK â†’ purchasing_items.id)
verified (boolean)
âŒ No cost stored here
âŒ No supplier info
âŒ No prices
ğŸ”¹ STEP 1 â€” INGREDIENT MASTER API (READ / WRITE)
Create or confirm endpoints:
Copy code

GET    /api/ingredients
POST   /api/ingredients
PUT    /api/ingredients/:id
Behaviour
All fields editable except cost
linkedPurchasingItemId optional
Validation:
name required
baseUnit required
defaultPortion optional
ğŸ”¹ STEP 2 â€” INGREDIENT MASTER UI (CRITICAL)
Page:
Copy code

/operations/ingredients-master
Table columns (EXACT):
Copy code

Ingredient Name
Category
Base Unit
Default Portion
Linked Purchasing Item
Cost Preview (read-only)
Verified
Editable behaviour
Inline edit:
name
category
baseUnit (dropdown)
defaultPortion
linkedPurchasingItemId (dropdown from purchasing_items)
Verified toggle (manual only)
Cost Preview logic (READ-ONLY)
If linkedPurchasingItemId exists:
Copy code

purchasing unitCost / purchasing unit size
â†’ derive cost per baseUnit
âš ï¸ Display only
âš ï¸ Not stored
âš ï¸ Recipes not affected
ğŸ”¹ STEP 3 â€” PURCHASING LINK DROPDOWN
Dropdown source:
Copy code

GET /api/purchasing/items
Label format:
Copy code

Item Name â€” Brand â€” Unit Description â€” à¸¿UnitCost
Selection:
Saves linkedPurchasingItemId
Does NOT auto-calculate anything else
ğŸ”¹ STEP 4 â€” VERIFIED STATE RULES
New ingredients = verified = false
Verified can only be toggled manually
No auto-verify
No bulk verify
ğŸ”¹ STEP 5 â€” GUARD RAILS
âŒ Ingredient Master must NOT expose recipe fields
âŒ Ingredient Master must NOT show supplier pricing editor
âŒ No shopping list logic here
âŒ No recipe attachment UI
âœ… SUCCESS CONDITIONS (AGENT MUST CONFIRM)
Ingredient Master page loads with rows
All columns editable as specified
Purchasing items selectable per ingredient
Cost preview visible when linked
No recipes modified
No shopping list logic touched
ğŸ§¾ FINAL RESPONSE FORMAT (STRICT)
Agent must respond only with:
Copy code

PACK F COMPLETE â€” Ingredient Master refined and editable
or
Copy code

BLOCKED â€” <exact file + reason>
ğŸ§  WHAT THIS UNLOCKS NEXT (FYI ONLY)
PACK G â€” Manual Recipe Ingredient Assignment
PACK H â€” Portion-level costing
PACK I â€” Online Ordering ingredient-aware pricing
But none proceed until PACK F is reviewed by you.